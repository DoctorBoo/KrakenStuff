extends layout

block content
	script(src='/javascripts/jquery-1.10.2.js')
	script(src='http://d3js.org/d3.v3.js')
	script(src='/javascripts/bb.js')
	- var _ticks = ticks;
	- var _coin = coin;
	- var _bbParams = bbParams;
	- var ethTicks = [], daoTicks = [], btcTicks = [];
	- var headers = ["name!", "pair", "creation"] ;
	- var etheur = [];
	- var daoeur = [];
	- var ethBtc = [];
	- var isEth = !(_coin && (_coin.toLowerCase()!=='dao' || _coin.toLowerCase()!=='btc'));
	- var isBtc = !isEth && (_coin && _coin.toLowerCase()==='btc');
	- _ticks.forEach(function(t) {
	-	if(t.bbDataEth){
	-		etheur.push(t.bbDataEth);
	-		ethTicks.push(t);
	-	}
	-	if(t.bbDataDAO){
	-		daoeur.push(t.bbDataDAO);
	-		daoTicks.push(t);
	-	}
	-	if(t.bbDataBtc){
	-		ethBtc.push(t.bbDataBtc);
	-		btcTicks.push(t);
	-	}
	- })
	- var bbData = isEth && !isBtc ? etheur : !isBtc? daoeur : ethBtc;
	- var coinTicks= isEth && !isBtc ? [ethTicks.pop()] : !isBtc? [daoTicks.pop()] : [btcTicks.pop()];
		table.table.table-hover.table-bordered
			thead
			tr
			each header in headers
				th
					span= header
			tbody
			if coinTicks.length
				each tick in coinTicks
					tr
					td
						span= tick.name
					td
						span= tick.pair.c	
					td
						span= tick.creationAsString

	div#bb(data-bb= bbData)
	div#bbParams(data-bbParams=bbParams)

